"use strict";var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var l=e[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}return function(e,i,l){return i&&t(e.prototype,i),l&&t(e,l),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var YTPlayer=function(){function t(e){_classCallCheck(this,t),this.element=e.element,this.cb_playlist_click=e.cb_playlist_click,this.cb_init=e.cb_init,this.playlistId=this.element.getAttribute("data-playlist-id"),this.videoId=this.element.getAttribute("data-video-id"),this.playlistId?this.fetchPlaylist():this.fetchVideo()}return _createClass(t,[{key:"fetchVideo",value:function(){var t=this;gapi.client.youtube.videos.list({part:"snippet",id:this.videoId}).then(function(e){var i=e.result.items[0].snippet;t.showVideo(t.videoId),t.updateVideoInfo(i.title,i.description),"function"==typeof t.cb_init&&t.cb_init()})}},{key:"fetchPlaylist",value:function(){var t=this;gapi.client.youtube.playlistItems.list({part:"snippet",playlistId:this.playlistId,maxResults:50}).then(function(e){for(var i=e.result.items,l=void 0,a=0;a<i.length;a++){var n=i[a].snippet;t.addItem(n),0===a&&(l=n.resourceId.videoId)}t.showVideo(l);var r=t.element.querySelectorAll(".ytplayer-list li")[0];t.updatePlaylist(r),"function"==typeof t.cb_init&&t.cb_init()})}},{key:"updateVideo",value:function(t){var e=t.getAttribute("data-id");this.player.loadVideoById(e)}},{key:"updatePlaylist",value:function(t){var e=t.parentNode.querySelectorAll("li");Array.prototype.forEach.call(e,function(t,e){t.classList.remove("selected")}),t.classList.add("selected"),this.updateVideoInfo(t.getAttribute("data-title"),t.getAttribute("data-description"))}},{key:"updateVideoInfo",value:function(t,e){var i=this.element.querySelector(".ytplayer-title"),l=this.element.querySelector(".ytplayer-description");i&&(i.innerHTML=t),l&&(l.innerHTML=e)}},{key:"addItem",value:function(t){var e=this,i=this.element.querySelector(".ytplayer-list"),l=t.thumbnails.medium.url,a=t.resourceId.videoId,n='<img src="'+l+'" />',r=document.createElement("li");r.innerHTML=n,r.setAttribute("data-id",a),r.setAttribute("data-title",t.title),r.setAttribute("data-description",t.description),r.addEventListener("click",function(t){var i=t.target.parentNode;e.updatePlaylist(i),e.updateVideo(i),"function"==typeof e.cb_playlist_click&&e.cb_playlist_click(i)}),i.appendChild(r)}},{key:"showVideo",value:function(t){this.player=new YT.Player(this.element.querySelector(".ytplayer-video"),{videoId:t,playerVars:{autoplay:0,rel:0,showinfo:0},events:{}})}}]),t}();